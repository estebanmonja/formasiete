<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Forma Siete</title>
    <style>
        /* Minimalist Reset & Layout */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background-color: #000000;
            overflow: hidden; /* Disables native scrollbars */
            display: flex;
            justify-content: center;
            align-items: center;
            -webkit-tap-highlight-color: transparent; /* Removes blue tap box on mobile */
        }

        /* Image container */
        #stage {
            width: 500px;
            height: 500px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* The Image */
        #tangram-img {
            max-width: 100%;
            max-height: 100%;
            width: auto;
            height: auto;
            pointer-events: none; /* Passes clicks through to body */
            user-select: none;
            -webkit-user-drag: none;
        }
    </style>
</head>
<body>

    <div id="stage">
        <img id="tangram-img" src="imgs/0000.png" alt="Forma Siete">
    </div>

    <script>
        // --- Configuration ---
        const maxSequence = 21; // Goes up to sequence 021
        
        // --- State ---
        let currentIndex = 0;   // The sequence number (0 to 21)
        let isColored = 0;      // 0 = single color, 1 = colored

        const imgElement = document.getElementById('tangram-img');

        // --- Core Logic ---

        // Generates filename like "0051.png" (Sequence 5, Colored)
        function getFilename(index, colorState) {
            const sequenceString = String(index).padStart(3, '0'); // e.g., becomes "005"
            return `imgs/${sequenceString}${colorState}.png`;
        }

        function updateImage() {
            const newSrc = getFilename(currentIndex, isColored);
            imgElement.src = newSrc;
            
            // Optional: Preload adjacent images for smoothness
            preloadImage(currentIndex + 1, isColored);
            preloadImage(currentIndex, isColored === 0 ? 1 : 0);
        }

        function preloadImage(idx, clr) {
            if(idx > maxSequence || idx < 0) return;
            const img = new Image();
            img.src = getFilename(idx, clr);
        }

        function nextImage() {
            if (currentIndex < maxSequence) {
                currentIndex++;
                updateImage();
            }
        }

        function prevImage() {
            if (currentIndex > 0) {
                currentIndex--;
                updateImage();
            }
        }

        // --- Interaction Handlers ---

        // 1. CLICK / TAP to Toggle Color
        // Using 'click' on body captures taps anywhere on screen
        document.body.addEventListener('click', () => {
            isColored = isColored === 0 ? 1 : 0;
            updateImage();
        });

        // 2. SWIPE (Touch) to Navigate
        let touchStartY = 0;
        let touchEndY = 0;

        document.addEventListener('touchstart', (e) => {
            touchStartY = e.changedTouches[0].screenY;
        }, {passive: false});

        document.addEventListener('touchend', (e) => {
            touchEndY = e.changedTouches[0].screenY;
            handleSwipe();
        }, {passive: false});

        function handleSwipe() {
            const sensitivity = 50; // Minimum swipe distance in pixels
            if (touchEndY < touchStartY - sensitivity) {
                // Swiped UP -> Next
                nextImage();
            }
            if (touchEndY > touchStartY + sensitivity) {
                // Swiped DOWN -> Previous
                prevImage();
            }
        }

        // 3. SCROLL (Desktop Wheel) to Navigate
        // Added for easier testing on desktop
        window.addEventListener('wheel', (e) => {
            if (e.deltaY > 0) nextImage();
            else prevImage();
        });

    </script>
</body>
</html>